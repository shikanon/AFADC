<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>音色选择与克隆 - AI漫剧快造</title>
    <script src="https://unpkg.byted-static.com/coze/space_ppt_lib/1.0.3-alpha.12/lib/tailwindcss.js"></script>
    <script src="https://unpkg.byted-static.com/fortawesome/fontawesome-free/6.7.2/js/all.min.js" data-auto-replace-svg="nest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#8b5cf6',
                        tertiary: '#06b6d4',
                        success: '#10b981',
                        danger: '#ef4444',
                        warning: '#f59e0b',
                        info: '#3b82f6',
                        'text-primary': '#1f2937',
                        'text-secondary': '#6b7280',
                        'bg-light': '#f8fafc',
                        'border-light': '#e5e7eb'
                    },
                    boxShadow: {
                        'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
                        'card-hover': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)'
                    }
                }
            }
        }
    </script>
    <style>
        .sidebar-transition {
            transition: width 0.3s ease-in-out;
        }
        
        .voice-card-hover:hover {
            transform: translateY(-2px);
            transition: all 0.2s ease-in-out;
        }
        
        .nav-item-active {
            background-color: theme('colors.primary');
            color: white;
        }
        
        .nav-item-hover:hover {
            background-color: theme('colors.bg-light');
            color: theme('colors.primary');
        }
        
        .search-focus:focus {
            outline: none;
            border-color: theme('colors.primary');
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .voice-selected {
            border-color: theme('colors.primary');
            background-color: rgba(99, 102, 241, 0.05);
        }
        
        .progress-bar {
            transition: width 0.3s ease-in-out;
        }
        
        .audio-visualizer {
            display: none;
            height: 20px;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            border-radius: 10px;
            animation: audioWave 1.5s ease-in-out infinite;
        }
        
        @keyframes audioWave {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.2); }
        }
        
        .audio-playing .audio-visualizer {
            display: block;
        }
        
        .audio-playing .fa-play {
            display: none;
        }
        
        .audio-playing .fa-pause {
            display: inline;
        }
        
        .fa-pause {
            display: none;
        }
    </style>
</head>
<body class="bg-bg-light min-h-screen">
    <!-- 顶部导航栏 -->
    <header id="top-navbar" class="fixed top-0 left-0 right-0 bg-white border-b border-border-light h-16 z-50">
        <div class="flex items-center justify-between h-full px-6">
            <!-- Logo和产品名称 -->
            <div id="logo-section" class="flex items-center space-x-3">
                <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center">
                    <i class="fas fa-magic text-white text-sm"></i>
                </div>
                <h1 class="text-xl font-bold text-text-primary">AI漫剧快造</h1>
            </div>
            
            <!-- 全局搜索 -->
            <div id="global-search" class="flex-1 max-w-md mx-8">
                <div class="relative">
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary text-sm"></i>
                    <input type="text" id="global-search-input" placeholder="搜索项目、工作空间..." 
                           class="w-full pl-10 pr-4 py-2 border border-border-light rounded-lg search-focus">
                </div>
            </div>
            
            <!-- 右侧操作区 -->
            <div id="header-actions" class="flex items-center space-x-4">
                <!-- 消息通知 -->
                <button id="notification-btn" class="relative p-2 text-text-secondary hover:text-primary">
                    <i class="fas fa-bell text-lg"></i>
                    <span class="absolute -top-1 -right-1 w-3 h-3 bg-danger rounded-full"></span>
                </button>
                
                <!-- 用户头像 -->
                <div id="user-menu" class="relative">
                    <button id="user-avatar-btn" class="flex items-center space-x-2 p-1 rounded-lg hover:bg-bg-light">
                        <img src="https://s.coze.cn/image/E99AUeuz7R4/" 
                             alt="用户头像" class="w-8 h-8 rounded-full" data-category="人物">
                        <span class="text-sm text-text-primary">张小明</span>
                        <i class="fas fa-chevron-down text-xs text-text-secondary"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- 左侧菜单 -->
    <aside id="sidebar" class="fixed left-0 top-16 bottom-0 w-60 bg-white border-r border-border-light sidebar-transition z-40">
        <nav id="sidebar-nav" class="p-4 space-y-2">
            <!-- 工作空间 -->
            <div id="workspace-section" class="mb-6">
                <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3">工作空间</h3>
                <div class="space-y-1">
                    <a href="P-WORKSPACE_LIST.html" id="nav-workspace-list" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-layer-group w-4"></i>
                        <span>工作空间管理</span>
                    </a>
                </div>
            </div>
            
            <!-- 项目管理 -->
            <div id="project-section" class="mb-6">
                <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3">项目管理</h3>
                <div class="space-y-1">
                    <a href="P-PROJECT_LIST.html" id="nav-project-list" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-folder w-4"></i>
                        <span>项目列表</span>
                    </a>
                </div>
            </div>
            
            <!-- 制作流程 -->
            <div id="workflow-section" class="mb-6">
                <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3">制作流程</h3>
                <div class="space-y-1">
                    <a href="P-SCRIPT_INFO.html" id="nav-script-info" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-file-alt w-4"></i>
                        <span>剧本信息</span>
                    </a>
                    <a href="P-CHARACTER_GENERATION.html" id="nav-character" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-user-friends w-4"></i>
                        <span>角色IP形象</span>
                    </a>
                    <a href="P-VOICE_SELECTION.html" id="nav-voice" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-active">
                        <i class="fas fa-microphone w-4"></i>
                        <span>音色选择</span>
                    </a>
                    <a href="P-SCENARIO_EDITOR.html" id="nav-scenario" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-film w-4"></i>
                        <span>分镜脚本</span>
                    </a>
                    <a href="P-IMAGE_GENERATION.html" id="nav-image" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-image w-4"></i>
                        <span>分镜画面</span>
                    </a>
                    <a href="P-VIDEO_GENERATION.html" id="nav-video" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-video w-4"></i>
                        <span>分镜视频</span>
                    </a>
                    <a href="P-VIDEO_EXPORT.html" id="nav-export" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-download w-4"></i>
                        <span>视频导出</span>
                    </a>
                </div>
            </div>
            
            <!-- 素材库 -->
            <div id="material-section">
                <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3">素材库</h3>
                <div class="space-y-1">
                    <a href="P-MATERIAL_LIBRARY.html" id="nav-material" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-palette w-4"></i>
                        <span>素材库管理</span>
                    </a>
                </div>
            </div>
        </nav>
    </aside>

    <!-- 主内容区 -->
    <main id="main-content" class="ml-60 mt-16 p-6 min-h-screen">
        <!-- 页面头部 -->
        <div id="page-header" class="mb-6">
            <!-- 面包屑导航 -->
            <nav id="breadcrumb" class="mb-4">
                <ol class="flex items-center space-x-2 text-sm text-text-secondary">
                    <li><a href="P-PROJECT_LIST.html" class="hover:text-primary">项目管理</a></li>
                    <li><i class="fas fa-chevron-right text-xs"></i></li>
                    <li><span class="text-text-primary">樱花之恋</span></li>
                    <li><i class="fas fa-chevron-right text-xs"></i></li>
                    <li><span class="text-text-primary">音色选择与克隆</span></li>
                </ol>
            </nav>
            
            <!-- 页面标题和操作 -->
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold text-text-primary mb-2">音色选择与克隆</h1>
                    <p class="text-text-secondary">选择角色和旁白的音色，或克隆自定义音色</p>
                </div>
                <div class="flex items-center space-x-3">
                    <button id="save-btn" class="px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:border-primary hover:text-primary">
                        <i class="fas fa-save mr-2"></i>保存
                    </button>
                    <button id="next-btn" class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors">
                        <i class="fas fa-arrow-right mr-2"></i>下一步
                    </button>
                </div>
            </div>
        </div>

        <!-- 角色音色选择区 -->
        <div id="character-voice-section" class="bg-white rounded-xl shadow-card p-6 mb-6">
            <h2 class="text-lg font-semibold text-text-primary mb-4">
                <i class="fas fa-user-friends text-primary mr-2"></i>角色音色
            </h2>
            <p class="text-text-secondary mb-6">为您的角色选择合适的音色</p>
            
            <div id="character-voice-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- 角色音色选项1 -->
                <div id="character-voice-1" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer voice-selected">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">甜美少女</h3>
                        <button id="character-voice-1-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">温柔甜美的少女声线，适合青春校园题材</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="character-voice-1-select" class="text-xs bg-primary text-white px-3 py-1 rounded-full">已选择</button>
                    </div>
                </div>

                <!-- 角色音色选项2 -->
                <div id="character-voice-2" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">活泼少女</h3>
                        <button id="character-voice-2-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">充满活力的少女声线，适合开朗角色</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="character-voice-2-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>

                <!-- 角色音色选项3 -->
                <div id="character-voice-3" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">成熟女性</h3>
                        <button id="character-voice-3-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">优雅成熟的女性声线，适合知性角色</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="character-voice-3-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>

                <!-- 角色音色选项4 -->
                <div id="character-voice-4" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">阳光少年</h3>
                        <button id="character-voice-4-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">清爽阳光的少年声线，适合青春角色</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="character-voice-4-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>

                <!-- 角色音色选项5 -->
                <div id="character-voice-5" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">沉稳青年</h3>
                        <button id="character-voice-5-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">稳重成熟的青年声线，适合领导角色</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="character-voice-5-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>

                <!-- 角色音色选项6 -->
                <div id="character-voice-6" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">可爱萝莉</h3>
                        <button id="character-voice-6-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">天真可爱的萝莉声线，适合年幼角色</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="character-voice-6-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 旁白音色选择区 -->
        <div id="narrator-voice-section" class="bg-white rounded-xl shadow-card p-6 mb-6">
            <h2 class="text-lg font-semibold text-text-primary mb-4">
                <i class="fas fa-comment-dots text-secondary mr-2"></i>旁白音色
            </h2>
            <p class="text-text-secondary mb-6">选择适合的旁白音色来讲述故事</p>
            
            <div id="narrator-voice-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- 旁白音色选项1 -->
                <div id="narrator-voice-1" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer voice-selected">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">温和男声</h3>
                        <button id="narrator-voice-1-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">温和稳重的男性旁白，适合温馨故事</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="narrator-voice-1-select" class="text-xs bg-primary text-white px-3 py-1 rounded-full">已选择</button>
                    </div>
                </div>

                <!-- 旁白音色选项2 -->
                <div id="narrator-voice-2" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">优雅女声</h3>
                        <button id="narrator-voice-2-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">优雅知性的女性旁白，适合文艺作品</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="narrator-voice-2-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>

                <!-- 旁白音色选项3 -->
                <div id="narrator-voice-3" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">深沉男声</h3>
                        <button id="narrator-voice-3-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">深沉有力的男性旁白，适合史诗故事</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="narrator-voice-3-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>

                <!-- 旁白音色选项4 -->
                <div id="narrator-voice-4" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">活泼女声</h3>
                        <button id="narrator-voice-4-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">活泼轻快的女性旁白，适合轻松故事</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="narrator-voice-4-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>

                <!-- 旁白音色选项5 -->
                <div id="narrator-voice-5" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">磁性男声</h3>
                        <button id="narrator-voice-5-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">富有磁性的男性旁白，适合情感故事</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="narrator-voice-5-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>

                <!-- 旁白音色选项6 -->
                <div id="narrator-voice-6" class="border border-border-light rounded-lg p-4 voice-card-hover cursor-pointer">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-medium text-text-primary">甜美女声</h3>
                        <button id="narrator-voice-6-play" class="text-primary hover:text-primary/80 audio-control">
                            <i class="fas fa-play text-sm"></i>
                            <i class="fas fa-pause text-sm"></i>
                            <div class="audio-visualizer ml-2"></div>
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary mb-3">甜美温柔的女性旁白，适合浪漫故事</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-secondary">预设音色</span>
                        <button id="narrator-voice-6-select" class="text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary">选择</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 音色克隆区 -->
        <div id="voice-clone-section" class="bg-white rounded-xl shadow-card p-6 mb-6">
            <h2 class="text-lg font-semibold text-text-primary mb-4">
                <i class="fas fa-clone text-tertiary mr-2"></i>音色克隆
            </h2>
            <p class="text-text-secondary mb-6">上传音频文件，克隆独特的自定义音色</p>
            
            <div id="voice-clone-form" class="space-y-4">
                <!-- 音频文件上传 -->
                <div class="border-2 border-dashed border-border-light rounded-lg p-6 text-center hover:border-primary/50 hover:bg-primary/5 transition-colors">
                    <div id="upload-area" class="cursor-pointer">
                        <i class="fas fa-cloud-upload-alt text-3xl text-text-secondary mb-3"></i>
                        <p class="text-text-primary font-medium mb-2">点击上传音频文件</p>
                        <p class="text-sm text-text-secondary">支持 MP3、WAV 格式，建议时长 30 秒以上</p>
                        <input type="file" id="audio-file-input" accept="audio/*" class="hidden">
                    </div>
                    
                    <!-- 上传进度 -->
                    <div id="upload-progress" class="hidden mt-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-text-secondary">上传中...</span>
                            <span id="upload-percentage" class="text-sm text-primary">0%</span>
                        </div>
                        <div class="w-full bg-border-light rounded-full h-2">
                            <div id="upload-progress-bar" class="bg-primary h-2 rounded-full progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 克隆进度 -->
                <div id="clone-progress" class="hidden">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm text-text-secondary">AI 克隆中...</span>
                        <span id="clone-percentage" class="text-sm text-primary">0%</span>
                    </div>
                    <div class="w-full bg-border-light rounded-full h-2">
                        <div id="clone-progress-bar" class="bg-gradient-to-r from-primary to-secondary h-2 rounded-full progress-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <!-- 克隆结果 -->
                <div id="clone-result" class="hidden">
                    <div class="bg-success/10 border border-success/20 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-medium text-success mb-1">音色克隆完成</h3>
                                <p class="text-sm text-text-secondary">您的自定义音色已准备就绪</p>
                            </div>
                            <button id="clone-voice-play" class="text-success hover:text-success/80 audio-control">
                                <i class="fas fa-play text-lg"></i>
                                <i class="fas fa-pause text-lg"></i>
                                <div class="audio-visualizer ml-2"></div>
                            </button>
                        </div>
                        <div class="mt-3 flex items-center space-x-3">
                            <button id="use-clone-character" class="px-4 py-2 bg-primary text-white rounded-lg text-sm hover:bg-primary/90">
                                <i class="fas fa-user-friends mr-1"></i>用作角色音色
                            </button>
                            <button id="use-clone-narrator" class="px-4 py-2 border border-border-light text-text-secondary rounded-lg text-sm hover:border-primary hover:text-primary">
                                <i class="fas fa-comment-dots mr-1"></i>用作旁白音色
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 音频参数设置区 -->
        <div id="audio-settings-section" class="bg-white rounded-xl shadow-card p-6 mb-8">
            <h2 class="text-lg font-semibold text-text-primary mb-4">
                <i class="fas fa-sliders-h text-info mr-2"></i>音频参数设置
            </h2>
            <p class="text-text-secondary mb-6">调整语音合成的参数以获得最佳效果</p>
            
            <div id="audio-settings-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 语速设置 -->
                <div>
                    <label for="speech-rate" class="block text-sm font-medium text-text-primary mb-3">
                        语速 <span id="speech-rate-value" class="text-primary">1.0x</span>
                    </label>
                    <input type="range" id="speech-rate" min="0.5" max="2.0" step="0.1" value="1.0" 
                           class="w-full h-2 bg-border-light rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-xs text-text-secondary mt-1">
                        <span>慢速</span>
                        <span>快速</span>
                    </div>
                </div>
                
                <!-- 音调设置 -->
                <div>
                    <label for="speech-pitch" class="block text-sm font-medium text-text-primary mb-3">
                        音调 <span id="speech-pitch-value" class="text-primary">1.0x</span>
                    </label>
                    <input type="range" id="speech-pitch" min="0.5" max="2.0" step="0.1" value="1.0" 
                           class="w-full h-2 bg-border-light rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-xs text-text-secondary mt-1">
                        <span>低沉</span>
                        <span>高亢</span>
                    </div>
                </div>
                
                <!-- 音量设置 -->
                <div>
                    <label for="speech-volume" class="block text-sm font-medium text-text-primary mb-3">
                        音量 <span id="speech-volume-value" class="text-primary">100%</span>
                    </label>
                    <input type="range" id="speech-volume" min="0" max="100" step="5" value="100" 
                           class="w-full h-2 bg-border-light rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-xs text-text-secondary mt-1">
                        <span>静音</span>
                        <span>最大</span>
                    </div>
                </div>
                
                <!-- 停顿设置 -->
                <div>
                    <label for="speech-pause" class="block text-sm font-medium text-text-primary mb-3">
                        句末停顿 <span id="speech-pause-value" class="text-primary">0.5秒</span>
                    </label>
                    <input type="range" id="speech-pause" min="0.1" max="2.0" step="0.1" value="0.5" 
                           class="w-full h-2 bg-border-light rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-xs text-text-secondary mt-1">
                        <span>短</span>
                        <span>长</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 底部操作区 -->
        <div id="bottom-actions" class="flex items-center justify-between bg-white rounded-xl shadow-card p-4">
            <button id="prev-btn" class="px-6 py-2 border border-border-light rounded-lg text-text-secondary hover:border-primary hover:text-primary">
                <i class="fas fa-arrow-left mr-2"></i>上一步
            </button>
            <div class="flex items-center space-x-3">
                <button id="save-bottom-btn" class="px-6 py-2 border border-border-light rounded-lg text-text-secondary hover:border-primary hover:text-primary">
                    <i class="fas fa-save mr-2"></i>保存
                </button>
                <button id="next-bottom-btn" class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors">
                    <i class="fas fa-arrow-right mr-2"></i>下一步
                </button>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 解析URL参数的辅助函数
            function getUrlParams() {
                const params = {};
                const queryString = window.location.search.substring(1);
                const urlParams = new URLSearchParams(queryString);
                
                for(const [key, value] of urlParams.entries()) {
                    params[key] = value;
                }
                return params;
            }

            // 获取URL参数
            const params = getUrlParams();
            const projectId = params.projectId || 'default';

            // 导航按钮点击事件
            document.querySelector('#nav-workspace-list').addEventListener('click', function() {
                window.location.href = 'P-WORKSPACE_LIST.html';
            });

            document.querySelector('#nav-project-list').addEventListener('click', function() {
                window.location.href = 'P-PROJECT_LIST.html';
            });

            document.querySelector('#nav-script-info').addEventListener('click', function() {
                window.location.href = `P-SCRIPT_INFO.html?projectId=${projectId}`;
            });

            document.querySelector('#nav-character').addEventListener('click', function() {
                window.location.href = `P-CHARACTER_GENERATION.html?projectId=${projectId}`;
            });

            document.querySelector('#nav-scenario').addEventListener('click', function() {
                window.location.href = `P-SCENARIO_EDITOR.html?projectId=${projectId}`;
            });

            document.querySelector('#nav-image').addEventListener('click', function() {
                window.location.href = `P-IMAGE_GENERATION.html?projectId=${projectId}`;
            });

            document.querySelector('#nav-video').addEventListener('click', function() {
                window.location.href = `P-VIDEO_GENERATION.html?projectId=${projectId}`;
            });

            document.querySelector('#nav-export').addEventListener('click', function() {
                window.location.href = `P-VIDEO_EXPORT.html?projectId=${projectId}`;
            });

            document.querySelector('#nav-material').addEventListener('click', function() {
                window.location.href = 'P-MATERIAL_LIBRARY.html';
            });

            // 页面操作按钮
            document.querySelector('#prev-btn').addEventListener('click', function() {
                window.location.href = `P-CHARACTER_GENERATION.html?projectId=${projectId}`;
            });

            document.querySelector('#next-btn').addEventListener('click', function() {
                window.location.href = `P-SCENARIO_EDITOR.html?projectId=${projectId}`;
            });

            document.querySelector('#next-bottom-btn').addEventListener('click', function() {
                window.location.href = `P-SCENARIO_EDITOR.html?projectId=${projectId}`;
            });

            // 保存按钮
            function saveSettings() {
                // 收集所有设置数据
                const settings = {
                    selectedCharacterVoice: document.querySelector('.voice-selected[data-type="character"]')?.id,
                    selectedNarratorVoice: document.querySelector('.voice-selected[data-type="narrator"]')?.id,
                    speechRate: document.querySelector('#speech-rate').value,
                    speechPitch: document.querySelector('#speech-pitch').value,
                    speechVolume: document.querySelector('#speech-volume').value,
                    speechPause: document.querySelector('#speech-pause').value,
                    clonedVoiceUsed: document.querySelector('#clone-result').classList.contains('hidden') ? false : true
                };
                
                console.log('保存音色设置:', settings);
                
                // 显示保存成功提示
                showSaveSuccess();
            }

            function showSaveSuccess() {
                // 创建临时提示元素
                const toast = document.createElement('div');
                toast.className = 'fixed top-20 right-6 bg-success text-white px-4 py-2 rounded-lg shadow-lg z-50';
                toast.innerHTML = '<i class="fas fa-check mr-2"></i>设置已保存';
                document.body.appendChild(toast);
                
                // 3秒后移除提示
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 3000);
            }

            document.querySelector('#save-btn').addEventListener('click', saveSettings);
            document.querySelector('#save-bottom-btn').addEventListener('click', saveSettings);

            // 音色选择功能
            function setupVoiceSelection(sectionType) {
                const voiceCards = document.querySelectorAll(`[id^="${sectionType}-voice-"]`);
                
                voiceCards.forEach(card => {
                    // 为卡片添加类型标识
                    card.setAttribute('data-type', sectionType);
                    
                    const selectBtn = card.querySelector(`[id^="${sectionType}-voice-"][id$="-select"]`);
                    const playBtn = card.querySelector(`[id^="${sectionType}-voice-"][id$="-play"]`);
                    
                    // 选择按钮点击事件
                    selectBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        
                        // 移除同类型的所有选中状态
                        document.querySelectorAll(`[data-type="${sectionType}"].voice-selected`).forEach(selectedCard => {
                            selectedCard.classList.remove('voice-selected');
                            const selectedBtn = selectedCard.querySelector(`[id$="-select"]`);
                            selectedBtn.className = 'text-xs border border-border-light text-text-secondary px-3 py-1 rounded-full hover:border-primary hover:text-primary';
                            selectedBtn.textContent = '选择';
                        });
                        
                        // 添加当前选中状态
                        card.classList.add('voice-selected');
                        selectBtn.className = 'text-xs bg-primary text-white px-3 py-1 rounded-full';
                        selectBtn.textContent = '已选择';
                        
                        console.log(`选择${sectionType === 'character' ? '角色' : '旁白'}音色:`, card.id);
                    });
                    
                    // 播放按钮点击事件
                    playBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        playAudioSample(playBtn, card.id);
                    });
                    
                    // 卡片点击事件（选择音色）
                    card.addEventListener('click', function() {
                        selectBtn.click();
                    });
                });
            }

            // 音频播放功能
            function playAudioSample(button, voiceId) {
                const isPlaying = button.classList.contains('audio-playing');
                
                // 停止所有正在播放的音频
                document.querySelectorAll('.audio-playing').forEach(playingBtn => {
                    playingBtn.classList.remove('audio-playing');
                });
                
                if (!isPlaying) {
                    // 开始播放当前音频
                    button.classList.add('audio-playing');
                    
                    console.log(`播放音频样本: ${voiceId}`);
                    
                    // 模拟音频播放时长
                    setTimeout(() => {
                        button.classList.remove('audio-playing');
                    }, 3000);
                }
            }

            // 设置角色和旁白音色选择
            setupVoiceSelection('character');
            setupVoiceSelection('narrator');

            // 音频文件上传功能
            const uploadArea = document.querySelector('#upload-area');
            const audioFileInput = document.querySelector('#audio-file-input');
            const uploadProgress = document.querySelector('#upload-progress');
            const cloneProgress = document.querySelector('#clone-progress');
            const cloneResult = document.querySelector('#clone-result');

            uploadArea.addEventListener('click', function() {
                audioFileInput.click();
            });

            audioFileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    console.log('选择音频文件:', file.name);
                    startFileUpload(file);
                }
            });

            function startFileUpload(file) {
                // 显示上传进度
                uploadProgress.classList.remove('hidden');
                
                // 模拟上传进度
                let progress = 0;
                const uploadInterval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(uploadInterval);
                        uploadProgress.classList.add('hidden');
                        startVoiceCloning();
                    }
                    
                    document.querySelector('#upload-progress-bar').style.width = progress + '%';
                    document.querySelector('#upload-percentage').textContent = Math.round(progress) + '%';
                }, 200);
            }

            function startVoiceCloning() {
                // 显示克隆进度
                cloneProgress.classList.remove('hidden');
                
                // 模拟克隆进度
                let progress = 0;
                const cloneInterval = setInterval(() => {
                    progress += Math.random() * 10;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(cloneInterval);
                        cloneProgress.classList.add('hidden');
                        showCloneResult();
                    }
                    
                    document.querySelector('#clone-progress-bar').style.width = progress + '%';
                    document.querySelector('#clone-percentage').textContent = Math.round(progress) + '%';
                }, 300);
            }

            function showCloneResult() {
                cloneResult.classList.remove('hidden');
                console.log('音色克隆完成');
            }

            // 克隆音色使用按钮
            document.querySelector('#use-clone-character').addEventListener('click', function() {
                console.log('将克隆音色用作角色音色');
                // 这里可以实现将克隆音色添加到角色音色列表的逻辑
                alert('克隆音色已添加到角色音色列表');
            });

            document.querySelector('#use-clone-narrator').addEventListener('click', function() {
                console.log('将克隆音色用作旁白音色');
                // 这里可以实现将克隆音色添加到旁白音色列表的逻辑
                alert('克隆音色已添加到旁白音色列表');
            });

            // 克隆结果试听按钮
            document.querySelector('#clone-voice-play').addEventListener('click', function() {
                playAudioSample(this, 'cloned-voice');
            });

            // 音频参数设置
            const sliders = [
                { id: 'speech-rate', valueId: 'speech-rate-value', suffix: 'x' },
                { id: 'speech-pitch', valueId: 'speech-pitch-value', suffix: 'x' },
                { id: 'speech-volume', valueId: 'speech-volume-value', suffix: '%' },
                { id: 'speech-pause', valueId: 'speech-pause-value', suffix: '秒' }
            ];

            sliders.forEach(slider => {
                const sliderElement = document.querySelector(`#${slider.id}`);
                const valueElement = document.querySelector(`#${slider.valueId}`);
                
                sliderElement.addEventListener('input', function() {
                    const value = this.value;
                    valueElement.textContent = value + slider.suffix;
                    console.log(`${slider.id} 设置为:`, value);
                });
            });

            // 全局搜索功能
            document.querySelector('#global-search-input').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                console.log('全局搜索:', searchTerm);
            });

            // 通知按钮
            document.querySelector('#notification-btn').addEventListener('click', function() {
                console.log('打开通知中心');
            });

            // 用户菜单
            document.querySelector('#user-avatar-btn').addEventListener('click', function() {
                console.log('打开用户菜单');
            });
        });
    </script>
</body>
</html>