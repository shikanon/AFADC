<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工作空间管理 - AI漫剧快造</title>
    <script src="https://unpkg.byted-static.com/coze/space_ppt_lib/1.0.3-alpha.12/lib/tailwindcss.js"></script>
    <script src="https://unpkg.byted-static.com/fortawesome/fontawesome-free/6.7.2/js/all.min.js" data-auto-replace-svg="nest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#8b5cf6',
                        tertiary: '#06b6d4',
                        success: '#10b981',
                        danger: '#ef4444',
                        warning: '#f59e0b',
                        info: '#3b82f6',
                        'text-primary': '#1f2937',
                        'text-secondary': '#6b7280',
                        'bg-light': '#f8fafc',
                        'border-light': '#e5e7eb'
                    },
                    boxShadow: {
                        'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
                        'card-hover': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)'
                    }
                }
            }
        }
    </script>
    <style>
        .sidebar-transition {
            transition: width 0.3s ease-in-out;
        }
        
        .workspace-card-hover:hover {
            transform: translateY(-2px);
            transition: all 0.2s ease-in-out;
        }
        
        .nav-item-active {
            background-color: theme('colors.primary');
            color: white;
        }
        
        .nav-item-hover:hover {
            background-color: theme('colors.bg-light');
            color: theme('colors.primary');
        }
        
        .search-focus:focus {
            outline: none;
            border-color: theme('colors.primary');
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
    </style>
</head>
<body class="bg-bg-light min-h-screen">
    <!-- 顶部导航栏 -->
    <header id="top-navbar" class="fixed top-0 left-0 right-0 bg-white border-b border-border-light h-16 z-50">
        <div class="flex items-center justify-between h-full px-6">
            <!-- Logo和产品名称 -->
            <div id="logo-section" class="flex items-center space-x-3">
                <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center">
                    <i class="fas fa-magic text-white text-sm"></i>
                </div>
                <h1 class="text-xl font-bold text-text-primary">AI漫剧快造</h1>
            </div>
            
            <!-- 全局搜索 -->
            <div id="global-search" class="flex-1 max-w-md mx-8">
                <div class="relative">
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary text-sm"></i>
                    <input type="text" id="global-search-input" placeholder="搜索项目、工作空间..." 
                           class="w-full pl-10 pr-4 py-2 border border-border-light rounded-lg search-focus">
                </div>
            </div>
            
            <!-- 右侧操作区 -->
            <div id="header-actions" class="flex items-center space-x-4">
                <!-- 消息通知 -->
                <button id="notification-btn" class="relative p-2 text-text-secondary hover:text-primary">
                    <i class="fas fa-bell text-lg"></i>
                    <span class="absolute -top-1 -right-1 w-3 h-3 bg-danger rounded-full"></span>
                </button>
                
                <!-- 用户头像 -->
                <div id="user-menu" class="relative">
                    <button id="user-avatar-btn" class="flex items-center space-x-2 p-1 rounded-lg hover:bg-bg-light">
                        <img src="https://s.coze.cn/image/dR3v8xLZa8U/" 
                             alt="用户头像" class="w-8 h-8 rounded-full" data-category="人物">
                        <span class="text-sm text-text-primary">张小明</span>
                        <i class="fas fa-chevron-down text-xs text-text-secondary"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- 左侧菜单 -->
    <aside id="sidebar" class="fixed left-0 top-16 bottom-0 w-60 bg-white border-r border-border-light sidebar-transition z-40">
        <nav id="sidebar-nav" class="p-4 space-y-2">
            <!-- 工作空间 -->
            <div id="workspace-section" class="mb-6">
                <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3">工作空间</h3>
                <div class="space-y-1">
                    <a href="P-WORKSPACE_LIST.html" id="nav-workspace-list" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-active">
                        <i class="fas fa-layer-group w-4"></i>
                        <span>工作空间管理</span>
                    </a>
                </div>
            </div>
            
            <!-- 项目管理 -->
            <div id="project-section" class="mb-6">
                <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3">项目管理</h3>
                <div class="space-y-1">
                    <a href="P-PROJECT_LIST.html" id="nav-project-list" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-folder w-4"></i>
                        <span>项目列表</span>
                    </a>
                </div>
            </div>
            
            <!-- 制作流程 -->
            <div id="workflow-section" class="mb-6">
                <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3">制作流程</h3>
                <div class="space-y-1">
                    <a href="P-SCRIPT_INFO.html" id="nav-script-info" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-file-alt w-4"></i>
                        <span>剧本信息</span>
                    </a>
                    <a href="P-CHARACTER_GENERATION.html" id="nav-character" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-user-friends w-4"></i>
                        <span>角色IP形象</span>
                    </a>
                    <a href="P-VOICE_SELECTION.html" id="nav-voice" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-microphone w-4"></i>
                        <span>音色选择</span>
                    </a>
                    <a href="P-SCENARIO_EDITOR.html" id="nav-scenario" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-film w-4"></i>
                        <span>分镜脚本</span>
                    </a>
                    <a href="P-IMAGE_GENERATION.html" id="nav-image" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-image w-4"></i>
                        <span>分镜画面</span>
                    </a>
                    <a href="P-VIDEO_GENERATION.html" id="nav-video" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-video w-4"></i>
                        <span>分镜视频</span>
                    </a>
                    <a href="P-VIDEO_EXPORT.html" id="nav-export" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-download w-4"></i>
                        <span>视频导出</span>
                    </a>
                </div>
            </div>
            
            <!-- 素材库 -->
            <div id="material-section">
                <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider mb-3">素材库</h3>
                <div class="space-y-1">
                    <a href="P-MATERIAL_LIBRARY.html" id="nav-material" 
                       class="flex items-center space-x-3 px-3 py-2 rounded-lg text-sm nav-item-hover">
                        <i class="fas fa-palette w-4"></i>
                        <span>素材库管理</span>
                    </a>
                </div>
            </div>
        </nav>
    </aside>

    <!-- 主内容区 -->
    <main id="main-content" class="ml-60 mt-16 p-6 min-h-screen">
        <!-- 页面头部 -->
        <div id="page-header" class="mb-6">
            <!-- 面包屑导航 -->
            <nav id="breadcrumb" class="mb-4">
                <ol class="flex items-center space-x-2 text-sm text-text-secondary">
                    <li><span class="text-text-primary">首页</span></li>
                    <li><i class="fas fa-chevron-right text-xs"></i></li>
                    <li><span class="text-text-primary">工作空间管理</span></li>
                </ol>
            </nav>
            
            <!-- 页面标题和操作 -->
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold text-text-primary mb-2">工作空间管理</h1>
                    <p class="text-text-secondary">管理和创建您的工作空间</p>
                </div>
                <button id="create-workspace-btn" class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors">
                    <i class="fas fa-plus mr-2"></i>创建工作空间
                </button>
            </div>
        </div>

        <!-- 工具栏 -->
        <div id="toolbar" class="bg-white rounded-xl shadow-card p-4 mb-6">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <!-- 搜索框 -->
                <div class="flex-1 max-w-md">
                    <div class="relative">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary"></i>
                        <input type="text" id="workspace-search" placeholder="搜索工作空间名称..." 
                               class="w-full pl-10 pr-4 py-2 border border-border-light rounded-lg search-focus">
                    </div>
                </div>
                
                <!-- 排序选项 -->
                <div class="flex items-center space-x-3">
                    <select id="workspace-sort" class="px-3 py-2 border border-border-light rounded-lg text-sm">
                        <option value="created_desc">创建时间 ↓</option>
                        <option value="created_asc">创建时间 ↑</option>
                        <option value="name_asc">名称 A-Z</option>
                        <option value="name_desc">名称 Z-A</option>
                        <option value="projects_desc">项目数量 ↓</option>
                        <option value="projects_asc">项目数量 ↑</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- 工作空间列表 -->
        <div id="workspace-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
            <!-- 工作空间卡片1 - 我的工作室（所有者） -->
            <div id="workspace-card-1" class="bg-white rounded-xl shadow-card workspace-card-hover cursor-pointer" data-workspace-id="workspace-1" data-role="owner">
                <div class="relative">
                    <img src="https://s.coze.cn/image/_ey5IzGbt6Y/" 
                         alt="工作空间预览图" class="w-full h-48 object-cover rounded-t-xl" data-category="艺术">
                    <div class="absolute top-3 right-3">
                        <span class="bg-primary/10 text-primary px-2 py-1 rounded-full text-xs font-medium">所有者</span>
                    </div>
                </div>
                <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold text-text-primary">我的工作室</h3>
                        <div class="flex items-center space-x-1">
                            <i class="fas fa-crown text-warning text-sm"></i>
                            <span class="text-xs text-text-secondary">所有者</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-4 line-clamp-2">个人创作空间，用于制作个人项目和练习作品</p>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="text-center">
                            <div class="text-lg font-bold text-text-primary">5</div>
                            <div class="text-xs text-text-secondary">项目</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-text-primary">3</div>
                            <div class="text-xs text-text-secondary">成员</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs text-text-secondary mb-4">
                        <span><i class="fas fa-calendar mr-1"></i>2024-01-15</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <button class="text-primary hover:text-primary/80 text-sm workspace-enter-btn" data-workspace-id="workspace-1">
                                <i class="fas fa-arrow-right mr-1"></i>进入
                            </button>
                            <button class="text-text-secondary hover:text-primary text-sm workspace-settings-btn" data-workspace-id="workspace-1">
                                <i class="fas fa-cog mr-1"></i>设置
                            </button>
                        </div>
                        <button class="text-text-secondary hover:text-danger text-sm workspace-leave-btn" data-workspace-id="workspace-1">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 工作空间卡片2 - 创意团队（成员） -->
            <div id="workspace-card-2" class="bg-white rounded-xl shadow-card workspace-card-hover cursor-pointer" data-workspace-id="workspace-2" data-role="member">
                <div class="relative">
                    <img src="https://s.coze.cn/image/aB1mNxqFw2o/" 
                         alt="工作空间预览图" class="w-full h-48 object-cover rounded-t-xl" data-category="艺术">
                    <div class="absolute top-3 right-3">
                        <span class="bg-info/10 text-info px-2 py-1 rounded-full text-xs font-medium">成员</span>
                    </div>
                </div>
                <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold text-text-primary">创意团队</h3>
                        <div class="flex items-center space-x-1">
                            <i class="fas fa-user text-info text-sm"></i>
                            <span class="text-xs text-text-secondary">成员</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-4 line-clamp-2">与朋友一起创作的团队空间，专注于商业项目开发</p>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="text-center">
                            <div class="text-lg font-bold text-text-primary">12</div>
                            <div class="text-xs text-text-secondary">项目</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-text-primary">8</div>
                            <div class="text-xs text-text-secondary">成员</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs text-text-secondary mb-4">
                        <span><i class="fas fa-calendar mr-1"></i>2024-01-10</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <button class="text-primary hover:text-primary/80 text-sm workspace-enter-btn" data-workspace-id="workspace-2">
                                <i class="fas fa-arrow-right mr-1"></i>进入
                            </button>
                        </div>
                        <button class="text-text-secondary hover:text-danger text-sm workspace-leave-btn" data-workspace-id="workspace-2">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 工作空间卡片3 - 影视工作室（成员） -->
            <div id="workspace-card-3" class="bg-white rounded-xl shadow-card workspace-card-hover cursor-pointer" data-workspace-id="workspace-3" data-role="member">
                <div class="relative">
                    <img src="https://s.coze.cn/image/ObZekgVipzc/" 
                         alt="工作空间预览图" class="w-full h-48 object-cover rounded-t-xl" data-category="艺术">
                    <div class="absolute top-3 right-3">
                        <span class="bg-info/10 text-info px-2 py-1 rounded-full text-xs font-medium">成员</span>
                    </div>
                </div>
                <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold text-text-primary">影视工作室</h3>
                        <div class="flex items-center space-x-1">
                            <i class="fas fa-user text-info text-sm"></i>
                            <span class="text-xs text-text-secondary">成员</span>
                        </div>
                    </div>
                    <p class="text-sm text-text-secondary mb-4 line-clamp-2">专业影视制作公司的内部创作空间</p>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="text-center">
                            <div class="text-lg font-bold text-text-primary">25</div>
                            <div class="text-xs text-text-secondary">项目</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-text-primary">15</div>
                            <div class="text-xs text-text-secondary">成员</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs text-text-secondary mb-4">
                        <span><i class="fas fa-calendar mr-1"></i>2024-01-05</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <button class="text-primary hover:text-primary/80 text-sm workspace-enter-btn" data-workspace-id="workspace-3">
                                <i class="fas fa-arrow-right mr-1"></i>进入
                            </button>
                        </div>
                        <button class="text-text-secondary hover:text-danger text-sm workspace-leave-btn" data-workspace-id="workspace-3">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 创建新工作空间卡片 -->
            <div id="create-new-workspace-card" class="border-2 border-dashed border-border-light rounded-xl p-8 text-center hover:border-primary/50 hover:bg-primary/5 transition-colors cursor-pointer">
                <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-plus text-primary text-2xl"></i>
                </div>
                <h3 class="font-semibold text-text-primary mb-2">创建新工作空间</h3>
                <p class="text-sm text-text-secondary">开始您的团队协作之旅</p>
            </div>
        </div>

        <!-- 分页 -->
        <div id="pagination" class="flex items-center justify-between bg-white rounded-xl shadow-card p-4">
            <div class="text-sm text-text-secondary">
                显示 1-3 条，共 3 条记录
            </div>
            <div class="flex items-center space-x-2">
                <button class="px-3 py-1 border border-border-light rounded text-sm text-text-secondary hover:border-primary hover:text-primary">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="px-3 py-1 bg-primary text-white rounded text-sm">1</button>
                <button class="px-3 py-1 border border-border-light rounded text-sm text-text-secondary hover:border-primary hover:text-primary">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </main>

    <!-- 创建工作空间弹窗 -->
    <div id="create-workspace-modal" class="fixed inset-0 bg-black/50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-xl w-full max-w-md">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-text-primary">创建工作空间</h3>
                        <button id="close-modal-btn" class="text-text-secondary hover:text-text-primary">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <form id="create-workspace-form" class="space-y-4">
                        <div>
                            <label for="workspace-name" class="block text-sm font-medium text-text-primary mb-2">工作空间名称</label>
                            <input type="text" id="workspace-name" name="workspace-name" 
                                   class="w-full px-3 py-2 border border-border-light rounded-lg search-focus" 
                                   placeholder="请输入工作空间名称" required>
                        </div>
                        
                        <div>
                            <label for="workspace-description" class="block text-sm font-medium text-text-primary mb-2">工作空间描述</label>
                            <textarea id="workspace-description" name="workspace-description" rows="3"
                                      class="w-full px-3 py-2 border border-border-light rounded-lg search-focus resize-none" 
                                      placeholder="请输入工作空间描述"></textarea>
                        </div>
                        
                        <div class="flex items-center justify-end space-x-3 pt-4">
                            <button type="button" id="cancel-create-btn" 
                                    class="px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:border-primary hover:text-primary">
                                取消
                            </button>
                            <button type="submit" 
                                    class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90">
                                创建
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 确认退出工作空间弹窗 -->
    <div id="leave-workspace-modal" class="fixed inset-0 bg-black/50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-xl w-full max-w-md">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-text-primary">确认退出</h3>
                        <button id="close-leave-modal-btn" class="text-text-secondary hover:text-text-primary">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-danger/10 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-sign-out-alt text-danger text-2xl"></i>
                        </div>
                        <p class="text-text-secondary mb-2">您确定要退出工作空间 "<span id="leave-workspace-name" class="font-medium text-text-primary"></span>" 吗？</p>
                        <p class="text-sm text-text-secondary">退出后您将无法访问该工作空间中的项目</p>
                    </div>
                    
                    <div class="flex items-center justify-end space-x-3">
                        <button type="button" id="cancel-leave-btn" 
                                class="px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:border-primary hover:text-primary">
                            取消
                        </button>
                        <button type="button" id="confirm-leave-btn" 
                                class="px-4 py-2 bg-danger text-white rounded-lg hover:bg-danger/90">
                            确认退出
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 创建工作空间弹窗控制
            const createWorkspaceBtn = document.querySelector('#create-workspace-btn');
            const createNewWorkspaceCard = document.querySelector('#create-new-workspace-card');
            const createWorkspaceModal = document.querySelector('#create-workspace-modal');
            const closeModalBtn = document.querySelector('#close-modal-btn');
            const cancelCreateBtn = document.querySelector('#cancel-create-btn');

            function openCreateModal() {
                createWorkspaceModal.classList.remove('hidden');
            }

            function closeCreateModal() {
                createWorkspaceModal.classList.add('hidden');
            }

            createWorkspaceBtn.addEventListener('click', openCreateModal);
            createNewWorkspaceCard.addEventListener('click', openCreateModal);
            closeModalBtn.addEventListener('click', closeCreateModal);
            cancelCreateBtn.addEventListener('click', closeCreateModal);

            // 点击弹窗外部关闭
            createWorkspaceModal.addEventListener('click', (e) => {
                if (e.target === createWorkspaceModal) {
                    closeCreateModal();
                }
            });

            // 创建工作空间表单提交
            document.querySelector('#create-workspace-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const workspaceName = document.querySelector('#workspace-name').value;
                const workspaceDescription = document.querySelector('#workspace-description').value;
                
                if (workspaceName.trim()) {
                    // 这里处理工作空间创建逻辑
                    console.log('创建工作空间:', { name: workspaceName, description: workspaceDescription });
                    alert('工作空间创建成功！');
                    closeCreateModal();
                    // 刷新页面或添加新的工作空间卡片
                    location.reload();
                }
            });

            // 工作空间卡片点击事件
            document.querySelectorAll('[id^="workspace-card-"]').forEach(card => {
                card.addEventListener('click', (e) => {
                    // 如果点击的是按钮，不触发卡片点击
                    if (e.target.closest('button')) {
                        return;
                    }
                    
                    const workspaceId = card.dataset.workspaceId;
                    const role = card.dataset.role;
                    console.log('点击工作空间卡片:', workspaceId, '角色:', role);
                    
                    // 进入工作空间
                    enterWorkspace(workspaceId);
                });
            });

            // 进入工作空间按钮
            document.querySelectorAll('.workspace-enter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const workspaceId = btn.dataset.workspaceId;
                    enterWorkspace(workspaceId);
                });
            });

            function enterWorkspace(workspaceId) {
                // 保存当前工作空间ID到本地存储或发送到后端
                localStorage.setItem('currentWorkspaceId', workspaceId);
                // 跳转到项目管理页
                window.location.href = `P-PROJECT_LIST.html?workspaceId=${workspaceId}`;
            }

            // 工作空间设置按钮
            document.querySelectorAll('.workspace-settings-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const workspaceId = btn.dataset.workspaceId;
                    console.log('打开工作空间设置:', workspaceId);
                    // 这里可以跳转到工作空间详情页或打开设置弹窗
                    alert('工作空间设置功能');
                });
            });

            // 退出工作空间按钮
            document.querySelectorAll('.workspace-leave-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const workspaceId = btn.dataset.workspaceId;
                    const workspaceCard = btn.closest('[data-workspace-id]');
                    const workspaceName = workspaceCard.querySelector('h3').textContent;
                    
                    // 显示确认退出弹窗
                    showLeaveModal(workspaceId, workspaceName);
                });
            });

            // 退出工作空间弹窗控制
            const leaveWorkspaceModal = document.querySelector('#leave-workspace-modal');
            const closeLeaveModalBtn = document.querySelector('#close-leave-modal-btn');
            const cancelLeaveBtn = document.querySelector('#cancel-leave-btn');
            const confirmLeaveBtn = document.querySelector('#confirm-leave-btn');
            const leaveWorkspaceNameSpan = document.querySelector('#leave-workspace-name');

            let workspaceToLeaveId = null;

            function showLeaveModal(workspaceId, workspaceName) {
                workspaceToLeaveId = workspaceId;
                leaveWorkspaceNameSpan.textContent = workspaceName;
                leaveWorkspaceModal.classList.remove('hidden');
            }

            function closeLeaveModal() {
                leaveWorkspaceModal.classList.add('hidden');
                workspaceToLeaveId = null;
            }

            closeLeaveModalBtn.addEventListener('click', closeLeaveModal);
            cancelLeaveBtn.addEventListener('click', closeLeaveModal);

            // 点击弹窗外部关闭
            leaveWorkspaceModal.addEventListener('click', (e) => {
                if (e.target === leaveWorkspaceModal) {
                    closeLeaveModal();
                }
            });

            // 确认退出工作空间
            confirmLeaveBtn.addEventListener('click', () => {
                if (workspaceToLeaveId) {
                    console.log('确认退出工作空间:', workspaceToLeaveId);
                    // 这里处理退出工作空间逻辑
                    alert('已退出工作空间');
                    closeLeaveModal();
                    // 刷新页面或移除工作空间卡片
                    location.reload();
                }
            });

            // 搜索功能
            document.querySelector('#workspace-search').addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                console.log('搜索工作空间:', searchTerm);
                
                // 过滤工作空间卡片
                document.querySelectorAll('[id^="workspace-card-"]').forEach(card => {
                    const workspaceName = card.querySelector('h3').textContent.toLowerCase();
                    const workspaceDescription = card.querySelector('p').textContent.toLowerCase();
                    
                    if (workspaceName.includes(searchTerm) || workspaceDescription.includes(searchTerm)) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            });

            // 排序功能
            document.querySelector('#workspace-sort').addEventListener('change', (e) => {
                const sortValue = e.target.value;
                console.log('排序工作空间:', sortValue);
                
                // 这里处理排序逻辑
                // 实际应用中会根据排序条件重新排列工作空间卡片
            });

            // 全局搜索功能
            document.querySelector('#global-search-input').addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                console.log('全局搜索:', searchTerm);
            });

            // 通知按钮
            document.querySelector('#notification-btn').addEventListener('click', () => {
                console.log('打开通知');
            });

            // 用户头像菜单
            document.querySelector('#user-avatar-btn').addEventListener('click', () => {
                console.log('打开用户菜单');
            });
        });
    </script>
</body>
</html>